# Note for hw1

**本文件夹包含以下内容：**

- BitOperation.py：存储课上介绍的比特操作函数
- 1d spin model.py：完成homework的源代码
- note.md：介绍源代码以及主要思路

## Homework

### Momentum Sector:

本题的哈密顿量具有平移对称性，因此它与平移算符可以同时对角化，本代码采用课上的提供的方法：
- 首先构造投影算符：
$$
P_k=\frac{1}{N}\sum_{j=0}^{N-1}e^{i\frac{2\pi}{N}kj}T^j
$$
- 然后将投影算符作用到representative矢量上生成平移算符的各个本征子空间。
- 接着写出哈密顿量在平移算符的各个本征子空间（即momentum sector）中的表示。
- 最后将哈密顿量分块对角化。

### Source Code:

数据存储格式以及其相应的物理含义在源代码中均有注释给出，在此不再赘述。这里给出源代码的大致框架：

1. 首先根据格点数目生成check_list（与课上完全一致）。
2. 划分子空间并且对子空间内的基矢重新标号。不同于第一次作业，在本题中各个momentum sector的基矢量是一个叠加态，因此我将基矢量存成了一个数组，其各个元素就是基矢量在binary基矢量下的系数。
3. 存储非零的哈密顿量矩阵元信息，分为对角项和非对角项，源代码将产生对角项和非对角项的过程都进行了封装。
4. 将哈密顿量在子空间中分块对角化并且寻找基态以及相应子空间信息，依次完成第一个问题。
5. 将求解给出的子空间中的基态转换成为总希尔伯特空间中的形式，并且依次完成第二个问题。

**需要特别说明的是，为了避免引起混淆，代码中提及的basis state都是指binary基矢量（即总的希尔伯特空间中的基矢量）。**

同时本次代码中由于用到的转换操作较多，因此大部分操作过程都被封装在函数中，每个函数都有相应的函数说明。

### Output

对于题设参数$g=1,J=1,h=1,N=8$，我的答案如下：

```
Q1:
for momentum sector 0: [-11.974500702877553, -11.890249884615946, -9.5141550826517, -9.255117224955708, -7.852488688797939, -6.290859685245456, -5.054631674278492, -4.0442981119468, -3.3723099802911016, -2.8866164839824546, -2.828427124746192, -2.446395196639573, -1.754550587400384, -1.4641016151377548, -1.4035204845619405, -1.232386563675824, -0.4248315265693116, -1.686798869289095e-16, 2.5626655740214526e-16, 3.1323312086404418e-16, 4.378732073714601e-16, 0.8802019706403429, 0.8994019466631462, 2.1188386742691283, 2.828427124746198, 2.8539929182922634, 3.0880669614695324, 3.8653455224915683, 4.34331496445051, 4.580454439899234, 5.464101615137763, 6.558873791814094, 7.226200430499851, 8.382094861471124, 11.130104818007657, 11.470020578521831]
for momentum sector 1: [-9.520599135177681, -9.143610276551843, -7.962927539294198, -6.2851269976592565, -4.5692884712429676, -4.152307745475319, -3.8271022448278242, -2.7656284492790877, -2.2658024021646272, -1.720803600800473, -1.362816958455197, -1.2537380905645241, -1.0927435679723223, -0.8564973674615048, -0.7179895691180487, 0.1286645128076743, 0.7029438607956199, 1.2441765883329603, 1.3339156262964218, 2.042391511945659, 2.242841370785928, 2.8413347692506155, 3.1887658323470998, 4.933047606553853, 4.957122017570332, 5.347727340820664, 5.36349782588703, 6.681218859502181, 7.1684339384958164, 9.320900754653046]
for momentum sector 2: [-9.759611007046011, -8.368704449456832, -7.138238181453882, -6.034082471408, -5.1371726216761795, -4.879554174058731, -3.809345026467066, -3.7880775064260397, -2.9446421020374722, -2.735036745475678, -2.502571208735914, -2.143994717296324, -1.9459800055115197, -1.6928066119532506, -0.955788523881144, -1.888682440177052e-16, -1.6972898727933533e-17, 0.29563433367003983, 0.9316429333565964, 0.9879190409152859, 1.7821390410254485, 1.8184342950999892, 2.288741525501324, 2.9218770385539896, 3.302665415875914, 3.6936656676278075, 4.000000000000005, 4.216756472042581, 5.684360506975648, 6.929873974427044, 7.665880550287116, 8.368622518141176, 8.947392039384154]
for momentum sector 3: [-8.983183826140609, -7.583289749816103, -6.104276501086714, -5.273521328122695, -5.104480889354835, -4.866338285350524, -4.356492297904436, -3.8713101901626135, -3.509592876147935, -3.2884717035213122, -2.494914237687067, -1.4991281117591364, -1.208732634105786, -0.7592103949754907, -0.7025817517002755, 0.41249358865126234, 0.7500979807325121, 1.088121442883035, 1.8217863728426908, 2.2743380328456464, 2.5079749213419764, 3.2184992482594152, 3.5122080625178618, 3.657304465334113, 4.1490456984661055, 4.9433797001583955, 6.328712805042531, 6.9587337499488156, 7.216755570811576, 10.766073137999559]
for momentum sector 4: [-7.174128358396091, -7.165745761965062, -6.650664903478072, -6.053485031695408, -5.983608801318586, -5.360796452078488, -4.760294788259627, -4.7235551660309225, -4.192145976607025, -3.3893339074026247, -2.6880297710581615, -2.5125512963710497, -2.260143772089153, -1.2427120179369102, -1.0842680110714678, -0.09328138779049243, -3.399281872544895e-16, 7.15236588712013e-16, 0.49863359234720206, 1.3053482208548004, 2.2601437720891533, 2.3319500997259675, 2.6034432377746706, 2.7174366305909876, 3.9999999999999956, 4.521246812394266, 4.634681729582703, 4.760294788259625, 5.30231558507224, 5.355358016195891, 5.662537715693342, 6.650664903478064, 9.609550741522192, 11.121139557968045]
for momentum sector 5: [-8.983183826140607, -7.583289749816084, -6.104276501086688, -5.273521328122693, -5.104480889354851, -4.866338285350532, -4.356492297904427, -3.8713101901626183, -3.5095928761479387, -3.2884717035213087, -2.4949142376870705, -1.499128111759139, -1.2087326341057836, -0.759210394975491, -0.702581751700278, 0.41249358865126196, 0.7500979807325122, 1.088121442883034, 1.821786372842688, 2.2743380328456495, 2.5079749213419684, 3.218499248259403, 3.512208062517861, 3.657304465334119, 4.149045698466102, 4.94337970015838, 6.3287128050425245, 6.958733749948811, 7.216755570811553, 10.766073137999594]
for momentum sector 6: [-9.759611007046004, -8.368704449456821, -7.138238181453906, -6.03408247140801, -5.137172621676191, -4.87955417405874, -3.809345026467071, -3.7880775064260384, -2.94464210203748, -2.7350367454756705, -2.502571208735924, -2.143994717296317, -1.9459800055115124, -1.6928066119532457, -0.955788523881143, -1.5310316320929845e-16, 3.6677056190321454e-16, 0.2956343336700403, 0.9316429333565965, 0.987919040915285, 1.7821390410254476, 1.8184342950999937, 2.288741525501325, 2.9218770385539874, 3.302665415875906, 3.6936656676278017, 4.000000000000002, 4.216756472042594, 5.684360506975646, 6.929873974427083, 7.665880550287117, 8.36862251814118, 8.947392039384157]
for momentum sector 7: [-9.520599135177667, -9.143610276551822, -7.962927539294202, -6.285126997659221, -4.56928847124296, -4.152307745475319, -3.827102244827822, -2.765628449279095, -2.265802402164622, -1.720803600800475, -1.3628169584551981, -1.2537380905645223, -1.0927435679723232, -0.8564973674615033, -0.7179895691180491, 0.1286645128076752, 0.7029438607956165, 1.244176588332959, 1.3339156262964205, 2.042391511945652, 2.242841370785931, 2.841334769250609, 3.1887658323470935, 4.933047606553865, 4.957122017570327, 5.347727340820667, 5.363497825887036, 6.681218859502197, 7.16843393849582, 9.320900754653003]
```
```
Q2:
ground state energy of each site: -1.496812587859694
expectation value of sigma_x: (0.4569519539796928+6.938893903907228e-18j)
expectation value of sigma_z: (9.742207041085749e-14+0j)
```

在代用样例参数时，本代码得出的结论与标准输出并不完全一致，但是相差也仅仅在e-15的数量级（主要体现在Q2的sigma_z）。