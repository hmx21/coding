# Note for hw5

**本文件夹包含以下内容：**

- Sub180221.py：Sample code
- note.md：介绍源代码以及主要思路
- variational_MPS.py：完成homework的源代码

## Homework

### Source Code:

源代码使用MPS变分法、精确对角化求解哈密顿量的基态并且计算了X、Z方向上的平均自旋。源代码中各个函数的用途均有注释说明，与课上重复部分在此不再赘述，下面介绍我在本次作业中用到的新的算法的大致思路。

- `OptTSite(Mpo, HL, HR, T, Method=0)`：我的代码中设计了`Method=2`的优化方案——即每次优化两个site，实现方法与Method=0类似，不过最终留下的T是一个矩阵，这是为了方便后续进行SVD分解。
- `OptT_SVD(Mpo, HL, HR, T)`：本函数与`Method=2`的优化方案配套使用。需要注意的是进行SVD分解之后要将`U,V,S`的相应维数修改为原先MPS中bond的维数。
- `MagnetZ(T),MagnetX(T)`：在变分法求出各个site位置上的MPS之后进一步计算平均自旋。我采用的方法是直接将MPS与其conjugate的右侧虚拟指标缩并（因为除开`T[0]`之外的MPS都是canonical form），将MPS与其conjugate的物理指标与$\sigma_x,\sigma_z$缩并。最棘手的是MPS及其conjugate的左侧虚拟指标，因为`T[0]`并不是canonical的，所以我需要用`T_mixterm`来将存储它们左侧的缩并对象。对于site=0的情况，直接将左侧虚拟指标缩并即可，对于site>0的情况，我需要将该site左侧的所有MPS及其conjugate进行缩并，存储在`T_mixterm`中，并且在每次迭代过程中及时update。
- `Get_Hamiltonian(Ns),MagnetZ_ED(V, Ns),MagnetX_ED(V, Ns)`：精确对角化方法构造哈密顿量，计算平均自旋，计算的思路与HW1、HW2类似，在此不再赘述。

### Output

对于题给参数$N_s=10$，代码运行结果如下：

> 使用MPS变分法的计算结果为
```
For the case of Ns = 10, Ds = 4, we can get:
===========================2-site optimization===========================
Energy per site: [-1.38599736 -1.38599736 -1.38599736 -1.38603311 -1.38606836 -1.38607924
 -1.38606836 -1.38603311 -1.38599736 -1.38599736]
Magnetization in x direction per site: [0.75257146 0.5956771  0.53905064 0.51493107 0.50523852 0.50549757
 0.51559023 0.5395461  0.59537335 0.75201396]
Magnetization in z direction per site: [-3.32555344e-09 -3.76459980e-09 -3.84556204e-09 -3.93484972e-09
 -4.09250267e-09 -4.08196765e-09 -4.13296791e-09 -4.93309121e-09
 -6.26371233e-09 -6.18801121e-09]
===========================1-site optimization===========================
Energy per site: [-1.38601012 -1.38601012 -1.38601012 -1.38601012 -1.38601012 -1.38601012
 -1.38601012 -1.38601012 -1.38601012 -1.38601012]
Magnetization in x direction per site: [0.75274596 0.59588556 0.53928493 0.51471839 0.50445565 0.50445565
 0.51471839 0.53928494 0.59588556 0.75274596]
Magnetization in z direction per site: [-2.68296137e-07 -3.00243523e-07 -3.07059991e-07 -3.15425693e-07
 -3.22623034e-07 -3.17485947e-07 -3.22157958e-07 -3.70376458e-07
 -4.33446869e-07 -4.13153804e-07]


For the case of Ns = 10, Ds = 6, we can get:
===========================2-site optimization===========================
Energy per site: [-1.38634154 -1.38634154 -1.38634154 -1.38634321 -1.38634516 -1.38634614
 -1.38634516 -1.38634321 -1.38634154 -1.38634154]
Magnetization in x direction per site: [0.75100641 0.59439619 0.53873172 0.51536292 0.50583399 0.50584792
 0.51538586 0.53870464 0.59430759 0.75091031]
Magnetization in z direction per site: [ 1.66650027e-12 -6.01735328e-12 -1.90232274e-11 -3.76886300e-11
 -4.36538583e-11 -3.09186565e-11 -8.06693046e-11 -1.10525533e-10
 -4.12336276e-11  5.36440337e-11]
===========================1-site optimization===========================
Energy per site: [-1.38634193 -1.38634194 -1.38634194 -1.38634194 -1.38634194 -1.38634194
 -1.38634194 -1.38634194 -1.38634194 -1.38634194]
Magnetization in x direction per site: [0.75101713 0.59441621 0.53876304 0.51539819 0.50584676 0.50584676
 0.51539808 0.53876293 0.59441613 0.75101711]
Magnetization in z direction per site: [-1.00497692e-07 -8.22677089e-08 -6.80368575e-08  1.24958848e-07
  5.90500182e-09 -1.14425969e-07  1.58752885e-07  1.77863881e-07
 -1.57996321e-07 -1.08912328e-07]
```
> 使用精确对角化方法的计算结果为：
```
===========================Exact diagonalization===========================
Energy per site: [-1.38635786]
Magnetization in x direction per site: [0.75092046 0.59433904 0.53876271 0.51547118 0.5059699  0.5059699
 0.51547118 0.53876271 0.59433904 0.75092046]
Magnetization in z direction per site: [-9.64645031e-14 -1.08205112e-13 -1.13367649e-13 -1.16531784e-13
 -1.18252630e-13 -1.17086896e-13 -1.16420762e-13 -1.13811738e-13
 -1.10148002e-13 -9.72694147e-14]
```

可以发现，$D_s=6$时用MPS变分法求解出的结果更接近于精确对角化的结果。